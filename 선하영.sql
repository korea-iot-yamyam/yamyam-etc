drop database IF EXISTS yamyam_time;
create database yamyam_time;

use yamyam_time;

CREATE TABLE `orders` (
	`id` BIGINT	PRIMARY KEY AUTO_INCREMENT,
    `store_id` BIGINT NOT NULL,
	`delivery_address` VARCHAR(255) NOT NULL,
	`total_price` INT NOT NULL,
	`order_date` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
    `order_state` ENUM('0', '1', '2') NOT NULL DEFAULT '0'
);

-- 예시 입력값
INSERT INTO `orders` (store_id, delivery_address, total_price, order_date, order_state)
VALUES
    (1, '서울시 강남구 테헤란로 123', 25000, '2024-11-01 12:34:56', '0'),
    (2, '서울시 서초구 반포대로 456', 30000, '2024-11-01 12:45:56', '1'),
    (3, '서울시 송파구 올림픽로 789', 20000, '2024-11-01 14:56:56', '2'),
    (4, '서울시 마포구 양화로 987', 15000, '2024-11-01 15:10:30', '0'),
    (5, '서울시 강서구 방화대로 654', 27000, '2024-11-01 16:20:15', '1'),
    (6, '서울시 관악구 봉천로 123', 21000, '2024-11-06 17:34:20', '2'),
    (7, '서울시 동작구 사당로 789', 33000, '2024-11-07 10:25:40', '0'),
    (8, '서울시 은평구 갈현로 456', 18000, '2024-11-08 11:45:10', '1'),
    (9, '서울시 노원구 한글비석로 654', 29000, '2024-11-09 12:15:55', '2'),
    (10, '서울시 서대문구 통일로 987', 34000, '2024-11-10 13:35:25', '0'),
    (11, '서울시 성북구 보문로 123', 22000, '2024-11-11 14:45:35', '1'),
    (12, '서울시 강동구 고덕로 456', 26000, '2024-11-12 15:55:45', '2'),
    (13, '서울시 종로구 세종대로 654', 30000, '2024-11-13 16:20:30', '0'),
    (14, '서울시 중구 퇴계로 789', 21000, '2024-11-14 17:25:10', '1'),
    (15, '서울시 용산구 녹사평대로 987', 28000, '2024-11-15 18:30:50', '2'),
    (16, '서울시 광진구 광나루로 123', 25000, '2024-11-16 19:35:20', '0'),
    (17, '서울시 강북구 오패산로 456', 31000, '2024-11-17 20:40:30', '1'),
    (18, '서울시 금천구 시흥대로 789', 19000, '2024-11-18 21:45:40', '2'),
    (19, '서울시 양천구 목동서로 654', 32000, '2024-11-19 22:50:50', '0'),
    (20, '서울시 중랑구 망우로 123', 27000, '2024-11-20 23:55:10', '1'),
    (21, '서울시 도봉구 창동로 456', 24000, '2024-11-21 10:00:20', '2'),
    (22, '서울시 구로구 경인로 789', 35000, '2024-11-22 11:10:30', '0'),
    (23, '서울시 동대문구 약령시로 654', 20000, '2024-11-23 12:20:40', '1'),
    (24, '서울시 서초구 양재대로 987', 22000, '2024-11-24 13:30:50', '2'),
    (25, '서울시 강남구 학동로 123', 26000, '2024-11-25 14:40:10', '0'),
    (26, '서울시 송파구 중대로 456', 24000, '2024-11-26 15:50:20', '1'),
    (27, '서울시 마포구 독막로 789', 28000, '2024-11-27 16:05:30', '2'),
    (28, '서울시 양천구 신정로 654', 21000, '2024-11-28 17:15:40', '0'),
    (29, '서울시 서대문구 연희로 987', 25000, '2024-11-29 18:25:50', '1'),
    (30, '서울시 은평구 증산로 123', 27000, '2024-11-30 19:35:10', '2'),
    (31, '서울시 동작구 대방동로 456', 33000, '2024-12-01 20:45:20', '0'),
    (32, '서울시 관악구 행운로 789', 19000, '2024-12-02 21:55:30', '1'),
    (33, '서울시 구로구 고척로 654', 22000, '2024-12-03 10:05:40', '2'),
    (34, '서울시 금천구 독산로 987', 30000, '2024-12-04 11:15:50', '0'),
    (35, '서울시 강북구 솔샘로 123', 25000, '2024-12-05 12:25:10', '1'),
    (36, '서울시 중랑구 신내로 456', 28000, '2024-12-06 13:35:20', '2'),
    (37, '서울시 서대문구 홍제동로 789', 18000, '2024-12-07 14:45:30', '0'),
    (38, '서울시 종로구 율곡로 654', 29000, '2024-12-08 15:55:40', '1'),
    (39, '서울시 중구 장충단로 987', 31000, '2024-12-09 16:05:50', '2'),
    (40, '서울시 용산구 새천년로 123', 26000, '2024-12-10 17:15:10', '0'),
    (41, '서울시 광진구 자양로 456', 23000, '2024-12-11 18:25:20', '1'),
    (42, '서울시 강서구 마곡중앙로 789', 30000, '2024-12-12 19:35:30', '2'),
    (43, '서울시 은평구 불광로 654', 20000, '2024-12-13 20:45:40', '0'),
    (44, '서울시 도봉구 방학로 987', 24000, '2024-12-14 21:55:50', '1'),
    (45, '서울시 강남구 역삼로 123', 22000, '2024-12-15 10:05:10', '2'),
    (46, '서울시 서초구 강남대로 456', 32000, '2024-12-16 11:15:20', '0'),
    (47, '서울시 동작구 흑석로 789', 21000, '2024-12-17 12:25:30', '1'),
    (48, '서울시 강동구 천호대로 654', 27000, '2024-12-18 13:35:40', '2'),
    (49, '서울시 중구 동호로 987', 25000, '2024-12-19 14:45:50', '0'),
    (50, '서울시 마포구 상암로 123', 29000, '2024-12-20 15:55:10', '1');
    
SELECT 
    DATE(o.order_date) AS date,
    HOUR(o.order_date) AS hour,
    SUM(o.total_price) AS revenue
FROM orders AS o
WHERE YEAR(o.order_date) = 2024 AND MONTH(o.order_date) = 11 AND DAY(o.order_date) = 1
GROUP BY DATE(o.order_date), HOUR(o.order_date)
ORDER BY date, hour;


